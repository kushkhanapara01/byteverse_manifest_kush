version: 0.1.0
jobId: "1171"
jobName: Secondary Sales snapshot
jobType: Curated Data Product
alias: Load_state_level_data1
discoveryPort:
  name: Secondary Sales snapshot
  description: ""
  category: ""
  image: https://google.com
  autofillUserinfo: ""
  tags: []
  extra: {}
  shortDescription: Short Description
  longDescription: Long Long Long Description
  industryDomain: ""
  function: ""
  regulatoryFields:
    dataPrivacy: ""
    customerInfo: ""
    dataOrigin: ""
    monetaryInfo: ""
inputPorts:
  - alias: Load_all_data_1
    description: Read secondary sales data
    tags: []
    extra: {}
    syncType: pull
    type: dataproduct
    dataSetUrn: ""
    filter: ""
    projection: []
    dataProductUrn: urn:dv:dataproduct:7da5cbd8-bc24-4d50-a359-e0175e7ef462
    persistDataFrame: false
    entity:
      advanceOptions:
        mergeSchema: false
productState:
  alias: Load_state_level_data
  refreshInterval: 0 0 31 2 *
  retentionVersions: ""
  updateStrategy: Overwrite
  logicalSchema:
    properties:
      statename:
        type: STRING
        description: ""
      town:
        type: STRING
        description: ""
      billdate:
        type: DATETIME
        description: ""
      salesvalue:
        type: STRING
        description: ""
  enforceSchemaMethod: Warning
  enforceSchema: true
  enableDataReconciliation: false
  isProfilingEnabled: true
  tableName: secondary_sales_town_level
  stateStoreType: iceberg
transformation:
  - alias: Spark_SQL_1
    type: SQL
    description: Select data on state and city level for sales value
    query: select statename,town,billdate,sum(salesvalue) as salesvalue from
      secondary_sales group by 1,2,3
    sequenceNo: 2
    references:
      - alias: Load_all_data_1
        sqlReference: secondary_sales
controlPort:
  dataQualityRules:
    NullValueCheck:
      productState:
        checks:
          - column: statename
            expression: ==
            number: 1
        referenceAlias: Load_state_level_data
outputPort:
  subscriptionChannels:
    - channelType: JDBC
      queryType: SQL
